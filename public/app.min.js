"use strict";function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var Bookmark=function(){function o(e,n){_classCallCheck(this,o),this.elementId=e;this.options=_extends({},{},n);var t=document.getElementById(this.elementId);if(t){t.addEventListener("click",this.handleClick.bind(this)),t.addEventListener("keyup",this.handleKeyUp.bind(this)),t.addEventListener("change",this.handleChange.bind(this));t.innerHTML="<div>\n      <svg xmlns='http://www.w3.org/2000/svg' class='bookmarkBtn' viewBox='0 0 512 512'>\n        <title>Bookmark</title>\n        <path d='M352 48H160a48 48 0 00-48 48v368l144-128 144 128V96a48 48 0 00-48-48z' fill='none' stroke='currentColor'\n          stroke-linecap='round' stroke-linejoin='round' stroke-width='32' />\n        </svg>\n        <div class='bookmarkPopup' id='bookmarkPopup'></div>\n        <div class='bookmarkContainer' id='bookmarkContainer'>\n          <div class='bookmark-topline'>\n            <span class=\"heading\">Bookmarks</span><button class='createNew'>Create new bookmark</button>\n          </div>\n          <div class='btn'>\n          </div>\n          <div>\n            <input class='search' type='text' id=\"myInput\" placeholder=\"Search\" onkeyup\"searchFunction()\">\n          </div>\n          <hr>\n          <div class='public'>\n              <svg class='public-caret caret' xmlns='http://www.w3.org/2000/svg' viewbox='0 0 512 512'>\n                <title>Caret Down</title>\n                <path d='M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z' />\n              </svg>\n\n              <span class=\"heading\">Public bookmarks <span id=\"publicCount\">(0)</span></span>\n              <div id=\"public-placeholder\" class=\"active\"><p class='public-text'>You have no public bookmarks</p>\n              <p class='public-text'>Right-click on a bookmark and select 'Make public'.</p>\n            \n          </div>\n        </div>\n          <div class='my-bookmarks'>\n            <svg class='myBookmarks-caret caret' xmlns='http://www.w3.org/2000/svg' viewbox='0 0 512 512'>\n              <title>Caret Down</title>\n              <path\n                d='M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z' />\n            </svg>\n            <span class=\"heading\">My bookmarks <span id=\"myBookmarksCount\">(0)</span></span>\n            <div id=\"myBookmarks-placeholder\" class=\"active\">\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class='createNewPopup' id='createForm'>\n    <div class='createTopline'>\n    <span class=\"heading\">Create bookmark</span>\n    <span class='closeCreate'><svg xmlns='http://www.w3.org/2000/svg' viewbox='0 0 512 512'>\n    <title>Close</title>\n    <path fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32'\n      d='M368 368L144 144M368 144L144 368' />\n  </svg></span></br>\n\n    </div>\n    <hr>\n    <div class=\"create-input\">\n    <label for='bookmarkName' class=\"title\">Title</label>\n      <input type='text' id='bookmarkName' name='bookmarkName'>\n      <label for='bookmarkDescription' class=\"description\">Description <span class='optional'>(optional)</span></label><br>\n      <input type='text' id='bookmarkDescription' name='bookmarkDescription'>\n      <div class=\"create-flex\"><button class='createSubmit' id='createSubmit'>Create</button>\n      </div>\n    </div>\n  </div>\n    ",this.render()}}return _createClass(o,[{key:"render",value:function(o){var a=document.getElementById("publicCount"),i=[],s=document.getElementById("myBookmarksCount"),l=[];this.options.app.createSessionObject({qInfo:{qId:"BookmarkList",qType:"BookmarkList"},qBookmarkListDef:{qType:"bookmark",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",sheetId:"/sheetId",selectionFields:"/selectionFields",creationDate:"/creationDate"}}}).then(function(e){e.getLayout().then(function(e){e.qBookmarkList.qItems.forEach(function(e){!0===e.qMeta.published?o?-1!==e.qMeta.title.toLowerCase().indexOf(o.toLowerCase())&&i.push(e):i.push(e):o?-1!==e.qMeta.title.toLowerCase().indexOf(o.toLowerCase())&&l.push(e):l.push(e)});var n="";i.forEach(function(e){n+='\n              <div class="public-li" id="public-li">\n              <span class="bookmarkText">'.concat(e.qMeta.title,'</span>\n              <div class="date-and-i">\n              <span class="bookmarkText">').concat(new Date(e.qMeta.createdDate).toLocaleString().slice(0,10),'</span>\n              <span class="infoBtn">\n              <svg xmlns="http://www.w3.org/2000/svg" class="i-icon-public" id="i-icon-public" viewBox="0 0 512 512">\n              <title>Information Circle</title>\n              <path d="M248 64C146.39 64 64 146.39 64 248s82.39 184 184 184 184-82.39 184-184S349.61 64 248 64z"\n               fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none"\n                stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M220 220h32v116"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10"\n               stroke-width="32" d="M208 340h88"/><path d="M248 130a26 26 0 1026 26 26 26 0 00-26-26z"/>\n               </svg>\n               </span>\n               </div>\n              </div>\n              <hr>\n              <div class="info-popup-public" id="info-popup-public">\n              <h5 class="description-heading">').concat(e.qMeta.description,"</h5>\n              <h5>Selections: </h5>\n              </div>\n              ")});var t="";l.forEach(function(e){console.log(e),t+='\n              <div class="myBookmarks-li">\n                  <span class="bookmarkText">'.concat(e.qMeta.title,'</span>\n                  <div class="date-and-i">\n                  <div class="test">\n                  <span class="bookmarkText">').concat(new Date(e.qMeta.createdDate).toLocaleString().slice(0,10),'</span>\n                  <span class="infoBtn">\n            '),-1!==e.qMeta.privileges.indexOf("delete")&&(t+=" <svg id=".concat(e.qInfo.qId," xmlns='http://www.w3.org/2000/svg' class='delete-icon'\n              viewBox='0 0 512 512'><title>Close</title><path fill='none'\n              stroke='currentColor' stroke-linecap='round' stroke-linejoin='round'\n                stroke-width='32' d='M368 368L144 144M368 144L144 368'/>\n                </svg>\n                </div>\n                ")),t+='<svg xmlns="http://www.w3.org/2000/svg" class="i-icon-my" id="i-icon-my" viewBox="0 0 512 512">\n            <title>Information Circle</title>\n            <path d="M248 64C146.39 64 64 146.39 64 248s82.39 184 184 184 184-82.39 184-184S349.61 64 248 64z"\n             fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none"\n              stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M220 220h32v116"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10"\n             stroke-width="32" d="M208 340h88"/><path d="M248 130a26 26 0 1026 26 26 26 0 00-26-26z"/>\n             </svg>\n             </span>\n             </div>\n             <hr>\n             <div class="info-popup-my" id="info-popup-my">\n             <h5 class="description-heading">'.concat(e.qMeta.description,"</h5>\n             <h5>Selections: </h5>\n             </div>\n             ")}),document.getElementById("public-placeholder").innerHTML=n,document.getElementById("myBookmarks-placeholder").innerHTML=t,a.textContent="("+i.length+")",s.textContent="("+l.length+")"})})}},{key:"handleKeyUp",value:function(){this.searchFunction()}},{key:"handleClick",value:function(e){var n=this,t=document.getElementById("bookmarkName"),o=document.getElementById("bookmarkDescription");(e.target.classList.contains("bookmarkBtn")&&this.openForm(),e.target.classList.contains("bookmarkPopup")&&(closeForm(),closeBookmark()),e.target.classList.contains("createNew")&&createNewBookmark(),e.target.classList.contains("closeCreate"))&&(document.getElementById("bookmarkPopup").style.backgroundColor="white",closeBookmark());if(e.target.classList.contains("public-caret")&&closePublicUL(),e.target.classList.contains("myBookmarks-caret")&&closeMyBookmarksUL(),e.target.classList.contains("createSubmit")){var a=document.getElementById("bookmarkPopup");this.options.app.createBookmark({qInfo:{qType:"bookmark"},qMetaDef:{title:"".concat(t.value),description:"".concat(o.value)}}).then(function(){n.render()}),closeBookmark(),a.style.backgroundColor="white"}e.target.classList.contains("delete-icon")&&this.options.app.destroyBookmark(e.target.id).then(function(){n.render()}),e.target.classList.contains("i-icon-public")&&openInfoPublic(),e.target.classList.contains("i-icon-my")&&openInfoMy()}},{key:"handleChange",value:function(e){e.target.classList.contains("search")&&this.render(e.target.value)}},{key:"searchFunction",value:function(){var e;e=document.getElementById("myInput").value.toLowerCase(),this.render(e)}},{key:"openForm",value:function(){var e=document.getElementById("bookmarkPopup");e&&(e.style.display="block");var n=document.getElementById("bookmarkContainer");n&&(n.style.display="block")}}]),o}();function openInfoPublic(){document.getElementById("info-popup-public").style.display="block",document.getElementById("info-popup-my").style.display="none"}function closeInfoPublic(){document.getElementById("info-popup-public").style.display="none"}function openInfoMy(){document.getElementById("info-popup-my").style.display="block",document.getElementById("info-popup-public").style.display="none"}function closeInfoMy(){document.getElementById("info-popup-my").style.display="none"}function closeForm(){document.getElementById("bookmarkPopup").style.display="none";var e=document.getElementById("bookmarkContainer");e&&(e.style.display="none")}function createNewBookmark(){var e=document.getElementById("createForm"),n=document.getElementById("bookmarkPopup"),t=document.getElementById("bookmarkContainer");e.style.display="flex",n.style.backgroundColor="#bdbdbd",t.style.opacity=".4"}function closeBookmark(){document.getElementById("createForm").style.display="none",document.getElementById("bookmarkContainer").style.opacity="1"}function closePublicUL(){document.getElementById("public-placeholder").classList.toggle("active")}function closeMyBookmarksUL(){document.getElementById("myBookmarks-placeholder").classList.toggle("active")}var session=enigma.create({schema:schema,url:"wss://ec2-3-86-99-193.compute-1.amazonaws.com/app/cee97e28-59cf-411f-acb5-c3a7f40ee7ac"});session.open().then(function(e){console.log(e),e.openDoc("cee97e28-59cf-411f-acb5-c3a7f40ee7ac").then(function(e){console.log(e);new Bookmark("websy-bookmark",{app:e})})});